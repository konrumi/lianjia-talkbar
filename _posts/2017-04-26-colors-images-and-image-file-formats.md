---
layout: post
title:  "漫谈色彩、图像与格式"
author: Mi Qimeng
date:   2017-04-26 11:00:00 +0800
categories: posts
---

> 　本文简单介绍了围绕 “人类如何定义一个色彩”、“计算机如何表示和存储一个色彩”、“不同的图像格式有哪些区别，分别适用于哪些场景” 等问题相关的知识。简单介绍了 “色彩模型”、“色域”、“色彩空间”、“位深度”、“通道”、“图像格式” 等概念。

　

---

　

## 色彩空间

　色彩空间帮助我们解决“如何表示一个色彩”的问题。

### 基本概念

- **色彩模型：**

  　使用**一组参数**来表示**一个色彩**的**数学模型**。

  ![色彩模型](/assets/img/color_model.jpg)

  > 　上图表示了一个通过 `红色（R）` `绿色（G）` `蓝色（B）` 3个参数表示一个色彩的色彩模型—— `RGB色彩模型` 。

- **色域：**

  　根据色彩空间定义方式的不同，其包含的色彩广度也是不同且有限的。此外，现在人类几乎无法产生单一波长的色光，即纯色的色光（目前最接近纯色的光源为激光，但其成本太高，无法用于显示设备），因此我们的显示设备也拥有其局限性，也无法表现所有的色彩。像这样的色彩范围，被我们称为**色域**。

  ![色域](/assets/img/color_space_1.jpg)

  > 　上图的背景图形为 `CIE1931` 色彩空间色度图，该色彩空间基于人类感受色彩的方式而规定，这里可先暂时粗略地将其认为是色彩的全集。而其中灰色三角则是 `sRGB` 的色域。

- **色彩空间：**

　在**色彩模型**中，引入一个特定的**映射函数**，即形成了**色彩空间**。

```
+---------+                    +---------+
| param 1 |                    |         |
| param 2 |                    |  color  |
| param 3 |  ---f(params)--->  |         |
| ...     |                    |         |
+---------+                    +---------+
```

　

### 常用色彩空间简介

- **加法混色**

  - `CIE1931`
  - `sRGB`
  - `Adobe RGB`

  ![加法混色色彩空间](/assets/img/color_space_2.jpg)
  
  > 　上图展示了3种色彩空间的示意图，其中sRGB、Adobe RGB是使用同样色彩模型（RGB色彩模型），使用不同映射关系的色彩空间。

  **CIE1931色度图的介绍**

  　在上图的CIE1931色彩空间中，边缘曲线被定义为纯色色光（单波长色光），曲线旁边的蓝色数字即为该色光对应的波长（单位: nm）。而区域中的其他颜色，都是由这些纯色光混合而成，如白色就是混合了所有色光（包含所有可见光波段的电磁波）的一种颜色。

  　展开说的话，该色彩空间将色彩分为 `色度` `亮度` 两个关键值，再将色度用 `x` `y` 参数确定。两个上面的色度图就是某一个特定亮度下的色度分布（可以视为该色彩空间的三维模型中，在亮度轴上的某个面的切片）。白色和灰色均不是某个单色的色彩，而是由多种色光叠加而成的，因此比较白色和灰色的色度是一样的，区别是亮度不同。

  **加法混色的特点**

  　刚才已经介绍过，在现实世界中，我们看到的不同色彩，是由各种波段的色光混合而成的。而加法混色指定色彩的方式，也与其类似。加法混色模型中，会指定N个作为**纯色**参数分量（如RGB色彩模型使用的是 `R` `G` `B` 这3个色彩分量），然后用这些纯色进行混合，以表示其他色彩。正因为这个特点，**加法混色的色彩模型，主要用于自发光的设备（如屏幕）。**

  　因此，加法混色的色彩模型在CIE1931空间中的色域通常表现为一个凸多边形，凸多边形的顶点就是该色彩模型定义的纯色，如RGB模型的色域体现就是一个三角形，定点就是 `R` `G` `B` 3个色彩，而色域中的其他色彩，都是由这3个纯色混合而成。这是因为在RGB色彩模型的应用情景中，如LED显示器上，每个像素也分别拥有 R G B 3个色彩的发光二极管，通过控制3个发光二极管不同的发光强度，以展示不同的色彩。
  
  这里有 [一个简单的显示器通过RGB模型显示色彩的demo](/assets/demo/rgb-demo.html) 。

  　目前在计算机显示器上应用最广泛的是 `sRGB色彩空间` ，而 `Adobe RGB色彩空间` 则采用了与sRGB不同的映射方式，以获得更广的色域，通常应用于设计与摄影领域。

- **减法混色**

  - `CMYK`

  ![CMYK色彩空间](/assets/img/cmyk_1.jpg)
  
  > 　上图展示了减法混色的代表——CMYK色彩空间的4个关键分量和混合结果。虽然3个分量就足够表示色彩了（正如在RGB色彩模型之中），但是CMYK引入了第四个分量，以便贴近实际的应用情景。
  
  　CMYK色彩空间主要用于印刷品，而非自发光物体，因为印刷品的显色原理是通过颜料吸收某个特定波长的光，反射其它波长的光而显示色彩的。因此除了印刷品本身以外，还取决于光源等环境信息。理论上，即便是一张彩色打印的图像，在红色单一色光的光源下观察时，我们也只能观察到红色的单色图像，因为入射光源根本没有其他颜色，打印制品自然也无法反射其他颜色的光。（但是事实上我们还是能或多或少地观察到其他颜色，因为我们很难获得只发射某个特定波长的光源，我们的红光中仍然混合了一些其他波段的光。）

  ![印刷颜料的显色原理](/assets/img/cmyk_2.gif)
  
  > 　上图动画简单展示了印刷颜料的显色原理。
  
  　在上图中，从理论上来讲，我们假定入射光是包含所有可见光波段的混合光，即包含了所有的色彩。而我们的打印介质（如打印纸）则不吸收光线，可以反射所有的光线，因此在没有打印任何颜料的时候，我们看到的打印纸是包含所有色光的白色。当我们打印青色颜料时，青色颜料会吸收红、黄、紫等波段的色光，只反射青色波段的色光，因此我们能看到青色。当我们再打印黄色颜料的时候，黄色颜料又会吸收红、蓝、紫等波段的色光，与青色颜料混合后，只能反射绿色波段的色光，因此青色和黄色颜料混合后，我们看到的是绿色。最后，当我们再打印品红色颜料的时候，所有波段的色光都会被吸收，没有任何光线，因此我们应当看到纸是黑色的。
  
  　但是实际上，我们专门引入了一个黑色颜料，原因如下：
  
  1. `C` `M` `Y` 3种颜料混合后，不能得到真正的黑色，混合颜料呈现的是接近于深褐色的一种颜色。
  2. 日常生活中，黑白打印是一个常用场景，如果不引入黑色颜料，打印黑色需要使用3种颜料，成本很高。
  
  　因此，为了贴近实际场景，CMYK使用了4种分量来表示一个色彩。
  
- **色彩概念**

  - `HSV/HSB`
  - `HSL`